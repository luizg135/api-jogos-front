<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savepoint</title>
    <link rel="icon" type="image/gif" href="https://github.com/luizg135/api-jogos-front/blob/main/Sif.gif?raw=true">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <style>
        :root {
            --bg-color: #0d1117;
            --surface-color: #161b22;
            --primary-text: #e6edf3;
            --secondary-text: #7d8590;
            --border-color: #30363d;
            --accent-purple: #9370db;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--primary-text);
            display: flex;
            align-items: center; /* Centraliza verticalmente o contêiner */
            justify-content: flex-start; /* Alinha o contêiner à esquerda */
            min-height: 100vh;
            margin: 0;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #301934 0%, #0d1117 100%);
            background-image: url('https://www.transparenttextures.com/patterns/dark-fish-skin.png'), linear-gradient(135deg, #301934 0%, #0d1117 100%);
        }

        .main-bg-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://us-a.tapas.io/sa/31/bb7d10de-96a5-4782-9ff4-82c2a257924a.png');
            background-size: cover;
            background-position: center;
            z-index: 0;
        }

        .login-container {
            position: fixed; /* Fixa na tela */
            left: 0; /* Alinha à esquerda */
            top: 0;
            bottom: 0;
            width: 400px; /* Largura fixa para o contêiner */
            max-width: 90%; /* Garante responsividade em telas menores */
            background-color: var(--surface-color);
            background-image: url('https://www.transparenttextures.com/patterns/dark-fish-skin.png');
            backdrop-filter: blur(10px);
            padding: 48px;
            border-right: 1px solid var(--border-color); /* Borda apenas na direita */
            border-radius: 0 16px 16px 0; /* Apenas cantos direitos arredondados */
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            animation: fadeIn 0.8s ease-out;
            transition: transform 0.5s ease-out; /* Transição para o efeito de saída */
            display: flex; /* Para alinhar o conteúdo internamente */
            flex-direction: column;
            justify-content: center; /* Centraliza o conteúdo verticalmente */
            align-items: center; /* Centraliza o conteúdo horizontalmente */
            z-index: 10; /* Garante que o contêiner de login fique acima do fundo interativo */
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-100%); /* Vem da esquerda */
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .login-container.slide-out-left {
            transform: translateX(-100%); /* Move para fora da tela à esquerda */
        }

        .login-header {
            margin-bottom: 32px; /* Mantém o espaçamento abaixo do h1 "Acessar Perfil" */
            position: relative;
            padding-top: 0; /* Removido padding-top */
        }

        .login-header h1 { /* Estilo para "Acessar Perfil" */
            font-size: 1.5em; /* Diminuído o tamanho da fonte */
            color: var(--secondary-text); /* Cor do texto "Usuário" e "Senha" */
            text-shadow: none; /* Removido text-shadow para este h1 */
            margin: 0;
            white-space: nowrap;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left; /* Mantém o texto da label alinhado à esquerda dentro do form-group */
            width: 100%; /* Garante que o form-group ocupe a largura total disponível */
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--secondary-text);
        }

        input {
            width: 100%;
            box-sizing: border-box;
            background-color: var(--bg-color);
            color: var(--primary-text);
            border: 1px solid var(--border-color);
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(147, 112, 219, 0.3);
        }

        button {
            width: 100%;
            padding: 14px;
            background-color: var(--accent-purple);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 24px;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }

        button:hover {
            background-color: #a884e9;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        #error-message {
            color: #da3633;
            margin-top: 16px;
            min-height: 1.2em;
        }

        /* Estilos para o fundo interativo de grade */
        .interactive-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            z-index: 1; /* Fica acima da imagem de fundo, abaixo do contêiner de login */
            pointer-events: none; /* Permite que eventos de mouse passem para os quadrados */
        }

        .interactive-background .grid-square {
            background-color: var(--bg-color); /* Cor escura para obscurecer a imagem */
            border: none; /* Sem bordas visíveis */
            transition: background-color 0.2s ease-out, transform 0.2s ease-out, opacity 0.2s ease-out;
            transform: scale(1); /* Estado inicial */
            pointer-events: auto; /* Permite que os quadrados individuais capturem eventos de mouse */
            opacity: 1; /* Totalmente opaco inicialmente */
        }

        .interactive-background .grid-square.active {
            background-color: transparent; /* Torna o quadrado transparente para revelar a imagem */
            transform: scale(0.9) rotate(5deg); /* Levemente menor e rotacionado para um efeito dinâmico */
            opacity: 0.3; /* Mais transparente para a imagem aparecer */
        }

        /* Estilos para o rodapé do login */
        .login-footer {
            margin-top: auto; /* Empurra para o final do contêiner */
            padding-top: 20px; /* Espaçamento acima do título */
            text-align: center;
        }

        .login-footer .artoriapi-title {
            font-family: 'Daydream', sans-serif;
            font-size: 2.5em; /* Fonte menor */
            line-height: 1;
        }

        .login-footer .artoriapi-title .artori {
            color: var(--accent-purple);
            text-shadow: 0 0 8px rgba(147, 112, 219, 0.5);
        }

        .login-footer .artoriapi-title .api {
            color: var(--secondary-text);
            text-shadow: 0 0 8px rgba(125, 133, 144, 0.3);
        }

        /* Ajuste para o formulário para controlar a largura */
        #login-form {
            width: 80%; /* Define a largura do formulário para 80% do contêiner */
            max-width: 300px; /* Limita a largura máxima do formulário */
            margin-top: 50px; /* Mantém o espaçamento superior */
        }
    </style>
</head>
<body>
    <div class="main-bg-image"></div> <!-- Contêiner para a imagem de fundo principal -->

    <div class="interactive-background" id="interactiveBackground">
        <!-- Quadrados da grade serão gerados aqui pelo JavaScript -->
    </div>

    <div class="login-container" id="loginContainer">
        <div class="login-header">
            <h1>Acessar Perfil</h1>
        </div>
        <form id="login-form">
            <div class="form-group">
                <label for="username">Usuário</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">Senha</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit">Entrar</button>
        </form>
        <p id="error-message"></p>

        <!-- Removido o login-footer com o título ARTORIAPI -->
    </div>

    <script>
        // Cores ajustadas para tons de roxo e cinza (adicionado aqui para ser usado no Daydream text)
        const chartColors = {
            purple: '#9370db',        // Roxo normal
            darkPurple: '#6a4a9c',    // Roxo escuro
            lightPurple: '#b89ceb',   // Roxo claro
            grey: '#7d8590',          // Cinza normal
            darkGrey: '#4a5057',      // Cinza escuro
            lightGrey: '#a5acb4'      // Cinza claro
        };

        const loginForm = document.getElementById('login-form');
        const errorMessage = document.getElementById('error-message');
        const loginContainer = document.getElementById('loginContainer');
        const interactiveBackground = document.getElementById('interactiveBackground');
        
        const loginApiUrl = 'https://api.savepoint-hub.com.br/api/login';

        let revealedSquares = []; // Armazena os quadrados atualmente revelados
        const maxRevealedSquares = 12; // Limite de quadrados revelados (entre 10-15)
        const fadeBackDelay = 800; // Tempo em ms para um quadrado voltar ao normal

        // Lógica para gerar a grade interativa
        document.addEventListener('DOMContentLoaded', () => {
            const gridSize = 10; // Número de quadrados por linha/coluna (ajustado para quadrados maiores)
            const totalSquares = gridSize * gridSize;

            interactiveBackground.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
            interactiveBackground.style.gridTemplateRows = `repeat(${gridSize}, 1fr)`;

            for (let i = 0; i < totalSquares; i++) {
                const square = document.createElement('div');
                square.classList.add('grid-square');
                
                square.addEventListener('mouseover', () => {
                    if (!square.classList.contains('active')) {
                        square.classList.add('active');
                        revealedSquares.push(square);

                        // Se exceder o limite, remove o quadrado mais antigo
                        if (revealedSquares.length > maxRevealedSquares) {
                            const oldestSquare = revealedSquares.shift(); // Remove o mais antigo da frente
                            setTimeout(() => {
                                oldestSquare.classList.remove('active');
                            }, fadeBackDelay);
                        }
                    }
                });

                // Não precisamos de um mouseout que remova imediatamente, a lógica acima cuida disso.
                // O quadrado permanece ativo até ser o mais antigo e exceder o limite.

                interactiveBackground.appendChild(square);
            }
        });


        loginForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            errorMessage.textContent = ''; 

            const username = event.target.username.value;
            const password = event.target.password.value;

            try {
                const response = await fetch(loginApiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                if (response.ok) {
                    const data = await response.json();
                    localStorage.setItem('jwt_token', data.access_token);
                    
                    // Adiciona a classe para iniciar a animação de saída
                    loginContainer.classList.add('slide-out-left');

                    // Redireciona após a animação (0.5s definido no CSS)
                    setTimeout(() => {
                        window.location.href = 'index.html'; 
                    }, 500); // Deve corresponder à duração da transição CSS
                    
                } else {
                    const errorData = await response.json();
                    errorMessage.textContent = errorData.msg || 'Falha no login.';
                }
            } catch (error) {
                errorMessage.textContent = 'Erro de conexão. Verifique se a API está no ar.';
            }
        });
    </script>
</body>
</html>
